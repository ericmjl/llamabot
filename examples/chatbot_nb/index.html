
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ericmjl.github.io/llamabot/examples/chatbot_nb/">
      
      
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Chatbot nb - llamabot</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../apidocs.css">
    
      <link rel="stylesheet" href="../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chatbots-in-a-jupyter-notebook" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="llamabot" class="md-header__button md-logo" aria-label="llamabot" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M384 512H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h304c26.5 0 48 21.5 48 48v288c0 20.9-13.4 38.7-32 45.3V448c17.7 0 32 14.3 32 32s-14.3 32-32 32zM96 384c-17.7 0-32 14.3-32 32s14.3 32 32 32h256v-64zm32-232c0 13.3 10.7 24 24 24h176c13.3 0 24-10.7 24-24s-10.7-24-24-24H152c-13.3 0-24 10.7-24 24m24 72c-13.3 0-24 10.7-24 24s10.7 24 24 24h176c13.3 0 24-10.7 24-24s-10.7-24-24-24z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            llamabot
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chatbot nb
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ericmjl/llamabot" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ericmjl/llamabot
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="llamabot" class="md-nav__button md-logo" aria-label="llamabot" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M384 512H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h304c26.5 0 48 21.5 48 48v288c0 20.9-13.4 38.7-32 45.3V448c17.7 0 32 14.3 32 32s-14.3 32-32 32zM96 384c-17.7 0-32 14.3-32 32s14.3 32 32 32h256v-64zm32-232c0 13.3 10.7 24 24 24h176c13.3 0 24-10.7 24-24s-10.7-24-24-24H152c-13.3 0-24 10.7-24 24m24 72c-13.3 0-24 10.7-24 24s10.7 24 24 24h176c13.3 0 24-10.7 24-24s-10.7-24-24-24z"/></svg>

    </a>
    llamabot
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ericmjl/llamabot" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ericmjl/llamabot
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/which-bot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Which Bot Should I Use?
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    How-To Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    How-To Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/cli-powered-by-llm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Build an LLM-Powered CLI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/generate-blog-banner-images/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generate Blog Banner Images
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/receipt-processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Process Receipts with LLM Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/data-analysis-agentbot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Build a Data Analysis Chatbot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/simplebot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SimpleBot Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/structuredbot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    StructuredBot Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/toolbot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ToolBot Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/agentbot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AgentBot Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/querybot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QueryBot Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/ollama/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using Ollama
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Working with Prompts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/recording_prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Recording Prompts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Chat UI
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Chat UI
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/chat-ui/simplebot-and-chatbot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SimpleBot and ChatBot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/chat-ui/querybot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QueryBot Chat UI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Bots
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Bots
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/bots/simplebot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SimpleBot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/bots/structuredbot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    StructuredBot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/bots/toolbot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ToolBot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/bots/agentbot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AgentBot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/bots/querybot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QueryBot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/bots/imagebot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ImageBot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Components
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Components
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/components/messages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Messages
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/components/tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/components/docstore/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DocStore
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/components/chat_memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chat Memory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    CLI
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    CLI
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/llamabot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LlamaBot CLI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Git Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/docs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docs Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/repo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Repository Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/blog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blog Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/notebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Notebook Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Python Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/log-viewer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Log Viewer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/mcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCP Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Design & Explanation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Design & Explanation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/unified_chat_memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Unified Chat Memory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/log_viewer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Log Viewer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/observability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observability
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/agents-build-own-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agents Build Own Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Contributing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script>
(function() {
  function addWidgetsRenderer() {
    var requireJsScript = document.createElement('script');
    requireJsScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js';

    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var jupyterWidgetsScript = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    jupyterWidgetsScript.src = widgetRendererSrc;

    document.body.appendChild(requireJsScript);
    document.body.appendChild(jupyterWidgetsScript);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://mybinder.org/v2/gh/ericmjl/llamabot/master?urlpath=lab%2Ftree%2Fdocs%2Fexamples%2Fchatbot_nb.ipynb"><img alt="Binder" src="https://mybinder.org/badge_logo.svg" /></a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="chatbots-in-a-jupyter-notebook">ChatBots in a Jupyter Notebook</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see how to use the ChatBot class to enable you to chat with Mistral inside a Jupyter notebook.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">llamabot</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChatBot</span>

<span class="n">code_tester</span> <span class="o">=</span> <span class="n">ChatBot</span><span class="p">(</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">You are a Python quality assurance developer who delivers high quality unit tests for code.</span>
<span class="sd">You write tests using PyTest and not the built-in unittest library.</span>
<span class="sd">Write the tests using test functions and not using classes and class methods</span>
<span class="sd">Here is the code to write tests against:</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="n">session_name</span><span class="o">=</span><span class="s2">&quot;code-tested&quot;</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;mistral/mistral-medium&quot;</span><span class="p">,</span>
    <span class="n">stream_target</span><span class="o">=</span><span class="s2">&quot;stdout&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">code_tester</span><span class="p">(</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">class ChatBot:</span>
<span class="sd">    &quot;&quot;&quot;Chat Bot that is primed with a system prompt, accepts a human message.</span>

<span class="sd">    Automatic chat memory management happens.</span>

<span class="sd">    h/t Andrew Giessel/GPT4 for the idea.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="sd">    def __init__(self, system_prompt, temperature=0.0, model_name=&quot;gpt-4&quot;):</span>
<span class="sd">        &quot;&quot;&quot;Initialize the ChatBot.</span>

<span class="sd">        :param system_prompt: The system prompt to use.</span>
<span class="sd">        :param temperature: The model temperature to use.</span>
<span class="sd">            See https://platform.openai.com/docs/api-reference/completions/create#completions/create-temperature</span>
<span class="sd">            for more information.</span>
<span class="sd">        :param model_name: The name of the OpenAI model to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="sd">        self.model = ChatOpenAI(</span>
<span class="sd">            model_name=model_name,</span>
<span class="sd">            temperature=temperature,</span>
<span class="sd">            streaming=True,</span>
<span class="sd">            verbose=True,</span>
<span class="sd">            callback_manager=CallbackManager([StreamingStdOutCallbackHandler()]),</span>
<span class="sd">        )</span>
<span class="sd">        self.chat_history = [</span>
<span class="sd">            SystemMessage(content=&quot;Always return Markdown-compatible text.&quot;),</span>
<span class="sd">            SystemMessage(content=system_prompt),</span>
<span class="sd">        ]</span>

<span class="sd">    def __call__(self, human_message) -&amp;gt; Response:</span>
<span class="sd">        &quot;&quot;&quot;Call the ChatBot.</span>

<span class="sd">        :param human_message: The human message to use.</span>
<span class="sd">        :return: The response to the human message, primed by the system prompt.</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="sd">        self.chat_history.append(HumanMessage(content=human_message))</span>
<span class="sd">        response = self.model(self.chat_history)</span>
<span class="sd">        self.chat_history.append(response)</span>
<span class="sd">        return response</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="p">)</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>Here are some tests for the ChatBot class using PyTest and test functions:
<div class="highlight"><pre><span></span><code>import pytest
from chatbot import ChatBot, SystemMessage, HumanMessage
from openai_mock import ChatOpenAI

def test_chatbot_init():
    system_prompt = &quot;You are a helpful assistant.&quot;
    chatbot = ChatBot(system_prompt)
    assert len(chatbot.chat_history) == 2
    assert isinstance(chatbot.chat_history[0], SystemMessage)
    assert isinstance(chatbot.chat_history[1], SystemMessage)
    assert chatbot.chat_history[0].content == &quot;Always return Markdown-compatible text.&quot;
    assert chatbot.chat_history[1].content == system_prompt

def test_chatbot_call():
    system_prompt = &quot;You are a helpful assistant.&quot;
    chatbot = ChatBot(system_prompt)
    human_message = &quot;What is the weather like today?&quot;
    response = chatbot(human_message)
    assert len(chatbot.chat_history) == 4
    assert isinstance(chatbot.chat_history[2], HumanMessage)
    assert isinstance(chatbot.chat_history[3], response.__class__)
    assert chatbot.chat_history[2].content == human_message

def test_chatbot_response():
    system_prompt = &quot;You are a helpful assistant.&quot;
    chatbot = ChatBot(system_prompt, model_name=&quot;gpt-3.5-turbo&quot;)
    human_message = &quot;What is the weather like today?&quot;
    response = chatbot(human_message)
    assert response.content.startswith(&quot;The weather today is&quot;)

@pytest.fixture
def chatbot():
    system_prompt = &quot;You are a helpful assistant.&quot;
    return ChatBot(system_prompt, model_name=&quot;gpt-3.5-turbo&quot;)

def test_chatbot_multiple_calls(chatbot):
    human_message1 = &quot;What is the weather like today?&quot;
    human_message2 = &quot;What is the traffic like today?&quot;
    chatbot(human_message1)
    chatbot(human_message2)
    assert len(chatbot.chat_history) == 6
    assert chatbot.chat_history[2].content == human_message1
    assert chatbot.chat_history[4].content == human_message2

def test_chatbot_temperature(chatbot):
    human_message = &quot;Tell me a joke.&quot;
    response1 = chatbot(human_message, temperature=0.0)
    response2 = chatbot(human_message, temperature=1.0)
    assert response1.content != response2.content

def test_chatbot_model_name(chatbot):
    human_message = &quot;Tell me a joke.&quot;
    chatbot2 = ChatBot(&quot;You are a funny comedian.&quot;, model_name=&quot;davinci&quot;)
    response1 = chatbot(human_message)
    response2 = chatbot2(human_message)
    assert response1.content != response2.content
</code></pre></div>
Note: I used the `openai_mock` library to mock the `ChatOpenAI` class for testing purposes. You can replace it with the actual implementation of the `ChatOpenAI` class.

Also, I assumed that the `Response` class has a `content` attribute that contains the text response from the model. If it's different, please adjust the tests accordingly.</code>
</pre>
</div>
</div>
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>
<code>AIMessage(content='Here are some tests for the ChatBot class using PyTest and test functions:\n```\nimport pytest\nfrom chatbot import ChatBot, SystemMessage, HumanMessage\nfrom openai_mock import ChatOpenAI\n\ndef test_chatbot_init():\n    system_prompt = "You are a helpful assistant."\n    chatbot = ChatBot(system_prompt)\n    assert len(chatbot.chat_history) == 2\n    assert isinstance(chatbot.chat_history[0], SystemMessage)\n    assert isinstance(chatbot.chat_history[1], SystemMessage)\n    assert chatbot.chat_history[0].content == "Always return Markdown-compatible text."\n    assert chatbot.chat_history[1].content == system_prompt\n\ndef test_chatbot_call():\n    system_prompt = "You are a helpful assistant."\n    chatbot = ChatBot(system_prompt)\n    human_message = "What is the weather like today?"\n    response = chatbot(human_message)\n    assert len(chatbot.chat_history) == 4\n    assert isinstance(chatbot.chat_history[2], HumanMessage)\n    assert isinstance(chatbot.chat_history[3], response.__class__)\n    assert chatbot.chat_history[2].content == human_message\n\ndef test_chatbot_response():\n    system_prompt = "You are a helpful assistant."\n    chatbot = ChatBot(system_prompt, model_name="gpt-3.5-turbo")\n    human_message = "What is the weather like today?"\n    response = chatbot(human_message)\n    assert response.content.startswith("The weather today is")\n\n@pytest.fixture\ndef chatbot():\n    system_prompt = "You are a helpful assistant."\n    return ChatBot(system_prompt, model_name="gpt-3.5-turbo")\n\ndef test_chatbot_multiple_calls(chatbot):\n    human_message1 = "What is the weather like today?"\n    human_message2 = "What is the traffic like today?"\n    chatbot(human_message1)\n    chatbot(human_message2)\n    assert len(chatbot.chat_history) == 6\n    assert chatbot.chat_history[2].content == human_message1\n    assert chatbot.chat_history[4].content == human_message2\n\ndef test_chatbot_temperature(chatbot):\n    human_message = "Tell me a joke."\n    response1 = chatbot(human_message, temperature=0.0)\n    response2 = chatbot(human_message, temperature=1.0)\n    assert response1.content != response2.content\n\ndef test_chatbot_model_name(chatbot):\n    human_message = "Tell me a joke."\n    chatbot2 = ChatBot("You are a funny comedian.", model_name="davinci")\n    response1 = chatbot(human_message)\n    response2 = chatbot2(human_message)\n    assert response1.content != response2.content\n```\nNote: I used the `openai_mock` library to mock the `ChatOpenAI` class for testing purposes. You can replace it with the actual implementation of the `ChatOpenAI` class.\n\nAlso, I assumed that the `Response` class has a `content` attribute that contains the text response from the model. If it\'s different, please adjust the tests accordingly.', role='assistant')</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, ChatBot keeps track of conversation memory/history automatically.
We can even access any item in the conversation by looking at the conversation history.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>__repr__</code> of a chatbot will simply print out the entire history:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">code_tester</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>
<code>[Human]

class ChatBot:
    """Chat Bot that is primed with a system prompt, accepts a human message.

    Automatic chat memory management happens.

    h/t Andrew Giessel/GPT4 for the idea.
    """

    def __init__(self, system_prompt, temperature=0.0, model_name="gpt-4"):
        """Initialize the ChatBot.

        :param system_prompt: The system prompt to use.
        :param temperature: The model temperature to use.
            See https://platform.openai.com/docs/api-reference/completions/create#completions/create-temperature
            for more information.
        :param model_name: The name of the OpenAI model to use.
        """
        self.model = ChatOpenAI(
            model_name=model_name,
            temperature=temperature,
            streaming=True,
            verbose=True,
            callback_manager=CallbackManager([StreamingStdOutCallbackHandler()]),
        )
        self.chat_history = [
            SystemMessage(content="Always return Markdown-compatible text."),
            SystemMessage(content=system_prompt),
        ]

    def __call__(self, human_message) -&gt; Response:
        """Call the ChatBot.

        :param human_message: The human message to use.
        :return: The response to the human message, primed by the system prompt.
        """
        self.chat_history.append(HumanMessage(content=human_message))
        response = self.model(self.chat_history)
        self.chat_history.append(response)
        return response


[AI]
Here are some tests for the ChatBot class using PyTest and test functions:
<div class="highlight"><pre><span></span><code>import pytest
from chatbot import ChatBot, SystemMessage, HumanMessage
from openai_mock import ChatOpenAI

def test_chatbot_init():
    system_prompt = &quot;You are a helpful assistant.&quot;
    chatbot = ChatBot(system_prompt)
    assert len(chatbot.chat_history) == 2
    assert isinstance(chatbot.chat_history[0], SystemMessage)
    assert isinstance(chatbot.chat_history[1], SystemMessage)
    assert chatbot.chat_history[0].content == &quot;Always return Markdown-compatible text.&quot;
    assert chatbot.chat_history[1].content == system_prompt

def test_chatbot_call():
    system_prompt = &quot;You are a helpful assistant.&quot;
    chatbot = ChatBot(system_prompt)
    human_message = &quot;What is the weather like today?&quot;
    response = chatbot(human_message)
    assert len(chatbot.chat_history) == 4
    assert isinstance(chatbot.chat_history[2], HumanMessage)
    assert isinstance(chatbot.chat_history[3], response.__class__)
    assert chatbot.chat_history[2].content == human_message

def test_chatbot_response():
    system_prompt = &quot;You are a helpful assistant.&quot;
    chatbot = ChatBot(system_prompt, model_name=&quot;gpt-3.5-turbo&quot;)
    human_message = &quot;What is the weather like today?&quot;
    response = chatbot(human_message)
    assert response.content.startswith(&quot;The weather today is&quot;)

@pytest.fixture
def chatbot():
    system_prompt = &quot;You are a helpful assistant.&quot;
    return ChatBot(system_prompt, model_name=&quot;gpt-3.5-turbo&quot;)

def test_chatbot_multiple_calls(chatbot):
    human_message1 = &quot;What is the weather like today?&quot;
    human_message2 = &quot;What is the traffic like today?&quot;
    chatbot(human_message1)
    chatbot(human_message2)
    assert len(chatbot.chat_history) == 6
    assert chatbot.chat_history[2].content == human_message1
    assert chatbot.chat_history[4].content == human_message2

def test_chatbot_temperature(chatbot):
    human_message = &quot;Tell me a joke.&quot;
    response1 = chatbot(human_message, temperature=0.0)
    response2 = chatbot(human_message, temperature=1.0)
    assert response1.content != response2.content

def test_chatbot_model_name(chatbot):
    human_message = &quot;Tell me a joke.&quot;
    chatbot2 = ChatBot(&quot;You are a funny comedian.&quot;, model_name=&quot;davinci&quot;)
    response1 = chatbot(human_message)
    response2 = chatbot2(human_message)
    assert response1.content != response2.content
</code></pre></div>
Note: I used the `openai_mock` library to mock the `ChatOpenAI` class for testing purposes. You can replace it with the actual implementation of the `ChatOpenAI` class.

Also, I assumed that the `Response` class has a `content` attribute that contains the text response from the model. If it's different, please adjust the tests accordingly.
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>On the other hand, accessing the <code>.messages</code> attribute of the ChatBot will give you access to all of the messages inside the conversation.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">code_tester</span><span class="o">.</span><span class="n">messages</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>
<code>[HumanMessage(content='\nclass ChatBot:\n    """Chat Bot that is primed with a system prompt, accepts a human message.\n\n    Automatic chat memory management happens.\n\n    h/t Andrew Giessel/GPT4 for the idea.\n    """\n\n    def __init__(self, system_prompt, temperature=0.0, model_name="gpt-4"):\n        """Initialize the ChatBot.\n\n        :param system_prompt: The system prompt to use.\n        :param temperature: The model temperature to use.\n            See https://platform.openai.com/docs/api-reference/completions/create#completions/create-temperature\n            for more information.\n        :param model_name: The name of the OpenAI model to use.\n        """\n        self.model = ChatOpenAI(\n            model_name=model_name,\n            temperature=temperature,\n            streaming=True,\n            verbose=True,\n            callback_manager=CallbackManager([StreamingStdOutCallbackHandler()]),\n        )\n        self.chat_history = [\n            SystemMessage(content="Always return Markdown-compatible text."),\n            SystemMessage(content=system_prompt),\n        ]\n\n    def __call__(self, human_message) -&gt; Response:\n        """Call the ChatBot.\n\n        :param human_message: The human message to use.\n        :return: The response to the human message, primed by the system prompt.\n        """\n        self.chat_history.append(HumanMessage(content=human_message))\n        response = self.model(self.chat_history)\n        self.chat_history.append(response)\n        return response\n\n    def __repr__(self):\n        """Return a string representation of the ChatBot.\n\n        :return: A string representation of the ChatBot.\n        """\n        representation = ""\n\n        for message in self.chat_history:\n            if isinstance(message, SystemMessage):\n                prefix = "[System]\n"\n            elif isinstance(message, HumanMessage):\n                prefix = "[Human]\n"\n            elif isinstance(message, AIMessage):\n                prefix = "[AI]\n"\n\n            representation += f"{prefix}{message.content}" + "\n\n"\n        return representation\n\n    def panel(self, show: bool = True):\n        """Create a Panel app that wraps a LlamaBot.\n\n        :param show: Whether to show the app.\n            If False, we return the Panel app directly.\n            If True, we call `.show()` on the app.\n        :return: The Panel app, either showed or directly.\n        """\n\n        text_input = pn.widgets.TextAreaInput(placeholder="Start chatting...")\n        chat_history = pn.Column(*[])\n        send_button = pn.widgets.Button(name="Send", button_type="primary")\n\n        def b(event):\n            """Button click handler.\n\n            :param event: The button click event.\n            """\n            chat_messages = []\n            for message in self.chat_history:\n                if isinstance(message, SystemMessage):\n                    pass\n                elif isinstance(message, HumanMessage):\n                    chat_markdown = pn.pane.Markdown(f"Human: {message.content}")\n                    chat_messages.append(chat_markdown)\n                elif isinstance(message, AIMessage):\n                    chat_markdown = pn.pane.Markdown(f"Bot: {message.content}")\n                    chat_messages.append(chat_markdown)\n\n            chat_messages.append(pn.pane.Markdown(f"Human: {text_input.value}"))\n            bot_reply = pn.pane.Markdown("Bot: ")\n            chat_messages.append(bot_reply)\n            chat_history.objects = chat_messages\n            markdown_handler = PanelMarkdownCallbackHandler(bot_reply)\n            self.model.callback_manager.set_handler(markdown_handler)\n            self(text_input.value)\n            text_input.value = ""\n\n        send_button.on_click(b)\n        input_pane = pn.Row(text_input, send_button)\n        output_pane = pn.Column(chat_history, scroll=True, height=500)\n\n        main = pn.Row(input_pane, output_pane)\n        app = pn.template.FastListTemplate(\n            site="ChatBot",\n            title="ChatBot",\n            main=main,\n            main_max_width="768px",\n        )\n        if show:\n            return app.show()\n        return app\n\n', role='user'),
 AIMessage(content='Here are some tests for the ChatBot class using PyTest:\n```python\nimport pytest\nfrom your_module import ChatBot, SystemMessage, HumanMessage\n\ndef test_init():\n    system_prompt = "You are a helpful assistant."\n    chatbot = ChatBot(system_prompt)\n    assert len(chatbot.chat_history) == 2\n    assert isinstance(chatbot.chat_history[0], SystemMessage)\n    assert isinstance(chatbot.chat_history[1], SystemMessage)\n    assert chatbot.chat_history[0].content == "Always return Markdown-compatible text."\n    assert chatbot.chat_history[1].content == system_prompt\n\ndef test_call():\n    system_prompt = "You are a helpful assistant."\n    chatbot = ChatBot(system_prompt)\n    human_message = "What\'s the weather like today?"\n    response = chatbot(human_message)\n    assert len(chatbot.chat_history) == 4\n    assert isinstance(chatbot.chat_history[2], HumanMessage)\n    assert isinstance(chatbot.chat_history[3], response.__class__)\n    assert chatbot.chat_history[2].content == human_message\n\ndef test_repr():\n    system_prompt = "You are a helpful assistant."\n    chatbot = ChatBot(system_prompt)\n    human_message = "What\'s the weather like today?"\n    chatbot(human_message)\n    expected_repr = (\n        "[System]\\n"\n        "Always return Markdown-compatible text.\\n\\n"\n        "[System]\\n"\n        "You are a helpful assistant.\\n\\n"\n        "[Human]\\n"\n        "What\'s the weather like today?\\n\\n"\n        "[AI]\\n"\n    )\n    assert repr(chatbot) == expected_repr\n\ndef test_panel():\n    system_prompt = "You are a helpful assistant."\n    chatbot = ChatBot(system_prompt)\n    app = chatbot.panel()\n    assert isinstance(app, type(pn.template.FastListTemplate()))\n```\nNote that the `test_panel` function assumes that the `pn` module is available in the test environment. If it is not, you may need to install it or mock it out for testing purposes.\n\nAlso note that the `test_call` function assumes that the `response` object has a `__class__` attribute that can be used to check its type. If this is not the case, you may need to modify the test to use a different method of checking the type of the response object.\n\nFinally, note that these tests are not exhaustive and may not cover all possible edge cases or error conditions. You may want to add additional tests to ensure that the `ChatBot` class is working correctly in all scenarios.', role='assistant')]</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can even access any arbitrary message.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">code_tester</span><span class="o">.</span><span class="n">messages</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>Here are some tests for the ChatBot class using PyTest:
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">your_module</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChatBot</span><span class="p">,</span> <span class="n">SystemMessage</span><span class="p">,</span> <span class="n">HumanMessage</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_init</span><span class="p">():</span>
    <span class="n">system_prompt</span> <span class="o">=</span> <span class="s2">&quot;You are a helpful assistant.&quot;</span>
    <span class="n">chatbot</span> <span class="o">=</span> <span class="n">ChatBot</span><span class="p">(</span><span class="n">system_prompt</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">chatbot</span><span class="o">.</span><span class="n">chat_history</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chatbot</span><span class="o">.</span><span class="n">chat_history</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SystemMessage</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chatbot</span><span class="o">.</span><span class="n">chat_history</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">SystemMessage</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">chatbot</span><span class="o">.</span><span class="n">chat_history</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">content</span> <span class="o">==</span> <span class="s2">&quot;Always return Markdown-compatible text.&quot;</span>
    <span class="k">assert</span> <span class="n">chatbot</span><span class="o">.</span><span class="n">chat_history</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">content</span> <span class="o">==</span> <span class="n">system_prompt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_call</span><span class="p">():</span>
    <span class="n">system_prompt</span> <span class="o">=</span> <span class="s2">&quot;You are a helpful assistant.&quot;</span>
    <span class="n">chatbot</span> <span class="o">=</span> <span class="n">ChatBot</span><span class="p">(</span><span class="n">system_prompt</span><span class="p">)</span>
    <span class="n">human_message</span> <span class="o">=</span> <span class="s2">&quot;What&#39;s the weather like today?&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chatbot</span><span class="p">(</span><span class="n">human_message</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">chatbot</span><span class="o">.</span><span class="n">chat_history</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chatbot</span><span class="o">.</span><span class="n">chat_history</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">HumanMessage</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chatbot</span><span class="o">.</span><span class="n">chat_history</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">response</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">chatbot</span><span class="o">.</span><span class="n">chat_history</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">content</span> <span class="o">==</span> <span class="n">human_message</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_repr</span><span class="p">():</span>
    <span class="n">system_prompt</span> <span class="o">=</span> <span class="s2">&quot;You are a helpful assistant.&quot;</span>
    <span class="n">chatbot</span> <span class="o">=</span> <span class="n">ChatBot</span><span class="p">(</span><span class="n">system_prompt</span><span class="p">)</span>
    <span class="n">human_message</span> <span class="o">=</span> <span class="s2">&quot;What&#39;s the weather like today?&quot;</span>
    <span class="n">chatbot</span><span class="p">(</span><span class="n">human_message</span><span class="p">)</span>
    <span class="n">expected_repr</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;[System]</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Always return Markdown-compatible text.</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;[System]</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;You are a helpful assistant.</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;[Human]</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;What&#39;s the weather like today?</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;[AI]</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="k">assert</span> <span class="nb">repr</span><span class="p">(</span><span class="n">chatbot</span><span class="p">)</span> <span class="o">==</span> <span class="n">expected_repr</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_panel</span><span class="p">():</span>
    <span class="n">system_prompt</span> <span class="o">=</span> <span class="s2">&quot;You are a helpful assistant.&quot;</span>
    <span class="n">chatbot</span> <span class="o">=</span> <span class="n">ChatBot</span><span class="p">(</span><span class="n">system_prompt</span><span class="p">)</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">chatbot</span><span class="o">.</span><span class="n">panel</span><span class="p">()</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">pn</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">FastListTemplate</span><span class="p">()))</span>
</code></pre></div>
Note that the `test_panel` function assumes that the `pn` module is available in the test environment. If it is not, you may need to install it or mock it out for testing purposes.

Also note that the `test_call` function assumes that the `response` object has a `__class__` attribute that can be used to check its type. If this is not the case, you may need to modify the test to use a different method of checking the type of the response object.

Finally, note that these tests are not exhaustive and may not cover all possible edge cases or error conditions. You may want to add additional tests to ensure that the `ChatBot` class is working correctly in all scenarios.
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>
</code></pre></div>

</div>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/ericmjl" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/ericmjl" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/ericmjl" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["instant", "tabs", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://unpkg.com/mermaid@10/dist/mermaid.min.js"></script>
      
        <script src="../../config.js"></script>
      
    
  </body>
</html>